#!/usr/bin/env bash

################################################################################
top=$(realpath "$(dirname "$0")/..")

################################################################################
# So other scripts can access the bin directory:
export HLWMRC_BIN="$top/bin"

################################################################################
function hc() {
  herbstclient "$@"
}

################################################################################
hc emit_hook reload

################################################################################
workspaces=(
  # Primary Monitor (10)
  GTD
  Social
  Hacking
  RFA
  Media
  School
  M0_7
  M0_8
  M0_9
  Scratch

  # Secondary Monitor (10)
  M1_1
  Social_2
  M1_3
  RFA_Apps
  M1_5
  School_Notes
  M1_7
  M1_8
  M1_9
  M1_10
)

hc try silent rename default "${workspaces[0]}"
for workspace in "${workspaces[@]}"; do
  hc add "$workspace"
done

################################################################################
# shellcheck source=keys
. "$top/config/keys"

# shellcheck source=theme
. "$top/config/theme"

################################################################################
# Basic settings:
hc set auto_detect_monitors on
hc set auto_detect_panels on
hc set focus_crosses_monitor_boundaries off
hc set focus_follows_mouse on
hc set focus_stealing_prevention on
hc set gapless_grid on
hc set hide_covered_windows on
hc set raise_on_focus_temporarily on
hc set show_frame_decorations if_empty
hc set smart_frame_surroundings on
hc set smart_window_surroundings off
hc set swap_monitors_to_get_tag off
hc set update_dragged_clients on

################################################################################
# Initial monitor settings:
hc detect_monitors

################################################################################
# Window rules:
hc unrule -F

# Default rule:
hc rule focus=on floatplacement=none

# Windows that shouldn't get the focus:
hc rule instance="popup" class="Emacs" focus=off

# Windows to float:
hc rule fixedsize floating=on
hc rule class~"[Pp]inentry" floating=on floatplacement=center
hc rule class="krdc" floating=on floatplacement=center

# Plasma:
hc rule class="systemsettings" floating=on
hc rule class~"[Pp]lasma" floating=on
hc rule instance="plasmashell" class="plasmashell" manage=off

# Standard types:
hc rule \
  windowtype~'TYPE_(DIALOG|UTILITY|SPLASH)' \
  floating=on floatplacement=center

hc rule \
  windowtype~'TYPE_(NOTIFICATION|ON_SCREEN_DISPLAY|DOCK|DESKTOP)' \
  manage=off

################################################################################
hc unlock

################################################################################
# Start hook scripts:
"$top/bin/hlwm-ffm-skip-floats.sh" &
